import numbers
import unittest
import market_data_engine as mde


class TestGetTickerQuotes(unittest.TestCase):
    def test_correct_answer(self):
        """Test if method returns correct data type"""
        query_result = mde.get_ticker_quotes('AAPL')
        self.assertTrue(isinstance(query_result, dict), "Function returns wrong data type")


class TestCleanMarketData(unittest.TestCase):
    def test_correct_answer(self):
        """Test if method works correct with correct data"""
        original = {1623936600: [129.8000030517578, 132.5500030517578, 129.64999389648438, 131.7899932861328],
         1624023000: [130.7100067138672, 131.50999450683594, 130.24000549316406, 130.4600067138672],
         1624282200: [130.3000030517578, 132.41000366210938, 129.2100067138672, 132.3000030517578],
         1624368600: [132.1300048828125, 134.0800018310547, 131.6199951171875, 133.97999572753906],
         1624455000: [133.77000427246094, 134.32000732421875, 133.22999572753906, 133.6999969482422],
         1624541400: [134.4499969482422, 134.63999938964844, 132.92999267578125, 133.41000366210938],
         1624627800: [133.4600067138672, 133.88999938964844, 132.80999755859375, 133.11000061035156],
         1624887000: [133.41000366210938, 135.25, 133.35000610351562, 134.77999877929688],
         1624973400: [134.8000030517578, 136.49000549316406, 134.35000610351562, 136.3300018310547],
         1625059800: [136.1699981689453, 137.41000366210938, 135.8699951171875, 136.9600067138672],
         1625146200: [136.60000610351562, 137.3300018310547, 135.75999450683594, 137.27000427246094],
         1625232600: [137.89999389648438, 140.0, 137.75, 139.9600067138672],
         1625578200: [140.07000732421875, 143.14999389648438, 140.07000732421875, 142.02000427246094],
         1625664600: [143.5399932861328, 144.88999938964844, 142.66000366210938, 144.57000732421875],
         1625751000: [141.5800018310547, 144.05999755859375, 140.6699981689453, 143.24000549316406],
         1625837400: [142.75, 145.64999389648438, 142.64999389648438, 145.11000061035156],
         1626096600: [146.2100067138672, 146.32000732421875, 144.0, 144.5],
         1626183000: [144.02999877929688, 147.4600067138672, 143.6300048828125, 145.63999938964844],
         1626269400: [148.10000610351562, 149.57000732421875, 147.67999267578125, 149.14999389648438],
         1626355800: [149.24000549316406, 150.0, 147.08999633789062, 148.47999572753906]}
        file = open('../data/test_market_data.csv')
        file_data = file.read()
        file.close()
        query_result = mde.clean_market_data(file_data)
        self.assertEqual(original, query_result, "Query result is different.")
